$(function(){
  var sender = $('form[name="register"]');
  var profile = $('form[name="user"]');
  var loader = $('.resposta');
  BASE = $("link[rel='base']").attr("href");
  FILE = BASE + "_app/controller.php";

  function hide(div){
    setTimeout(function(){
      $(div).find('div').fadeOut();
    }, 3000);
  }
  sender.submit(function(){
    var foto = $('#foto').val();
    var fullname = $('#fullname').val();
		var email = $('#email').val();
		var telephone = $('#telephone').val();

    if(foto == '' || fullname == '' || email == '' || telephone == ''){
			$('.retorno').html('<div class="alert alert-warning">Preencha todos os campos para se cadastrar!</div>');
			hide('.retorno');
		}else{

      $(this).ajaxSubmit({
        url: "_app/controller.php",
        data: {acao: "cadastro"},
        beforeSubmit: function(){
          loader.empty().html('<img class="form-load" src="assets/img/load.gif" alt="Aguarde carregando..." title="Aguarde carregando...">').fadeIn(500);
        },
        resetForm: true,
        success: function(resposta){
          loader.empty().html('<img class="form-load" src="assets/img/load.gif" alt="Aguarde carregando..." title="Aguarde carregando...">').fadeOut(500);
        }
      });
    }
    return false;
  });

  profile.submit(function(){
    var foto = $('#foto').val();
    var fullname = $('#fullname').val();
		var email = $('#email').val();
		var telephone = $('#telephone').val();

    if(foto == '' || fullname == '' || email == '' || telephone == ''){
			$('.retorno').html('<div class="alert alert-warning">Preencha todos os campos para se cadastrarpara editar o seu perfil!</div>');
			hide('.retorno');
		}else{
    $(this).ajaxSubmit({
      url: "_app/controller.php",
      data: {acao: "update"},
      beforeSubmit: function(){
        loader.empty().html('<img class="form-load" src="assets/img/load.gif" alt="Aguarde carregando..." title="Aguarde carregando...">').fadeIn(500);
      },
      resetForm: true,
      success: function(resposta){
        window.location.reload();
      }
    });
  }
    return false;
  });

  $(".delete").on("click", function(){
    var id = $(this).attr("id");
    var acao = $(this).attr("data-ca");
 
    $.ajax({
      url: "_app/controller.php",
      method: 'POST',
      data: {acao, id},
      success: function(resposta){
        window.location.reload();
      }
    });
  });

});

